---
title: CANet
thumbnail: /gallery/thumbnails/CANet.png
date: 2020-10-20 16:05:21
categories:
    - DeepLearning  
    - Few-Shot Segmentation  
    - CANet
tags: [DL, FSS, CANet]
---

> **CANet**(CANet: Class-Agnostic Segmentation Networks with Iterative Refinement and Attentive Few-Shot Learning)[[1]](https://openaccess.thecvf.com/content_CVPR_2019/papers/Zhang_CANet_Class-Agnostic_Segmentation_Networks_With_Iterative_Refinement_and_Attentive_Few-Shot_CVPR_2019_paper.pdf) consists of a **two-branch dense comparison module** which performs `multi-level feature comparison`, and an **iterative optimization module** which iteratively `refines the predicted results`. There are some details of reading and implementing it. 
<!-- more -->

# Contents
---
- **[Paper & Code & note](#Paper&Code&note)**
- **[Paper understanding](#Paper)**
- **[Code understanding](#Code)**
- **[Note](#Note)**
- **[References](#References)**

# Paper & Code & note
---
> **Paper**: [CANet: Class-Agnostic Segmentation Networks with Iterative Refinement and Attentive Few-Shot Learning](https://openaccess.thecvf.com/content_CVPR_2019/papers/Zhang_CANet_Class-Agnostic_Segmentation_Networks_With_Iterative_Refinement_and_Attentive_Few-Shot_CVPR_2019_paper.pdf)(CVPR 2019 paper)  
> **Code**: [PyTorch](https://github.com/icoz69/CaNet)  
> **Note**: [Mendeley](https://www.mendeley.com/reference-manager/reader/1fe59999-7986-3760-9924-695fecd6c003/32c4559f-6cf2-fcaf-4b03-753f5c6ea088)

# Paper
---
## Abstract
![CANet_Abstract.png](https://i.loli.net/2020/10/20/lWKYgRc4kZMs8ep.png)

## Problem Solution
![CANet_overview.png](https://i.loli.net/2020/10/20/wqXQiMj9tZUmbrE.png)
![CANet_PS.png](https://i.loli.net/2020/10/20/ZONXI7oTeGyMUVm.png)

## Conceptual Understanding
![CANet_network.png](https://i.loli.net/2020/10/20/9zvY3VFAf8QJWyB.png)
### Dense Comparison Module(DCM)
- **Feature Extractor**: features in **lower layers** often relate to low-level cues, e.g., `edges and colors` while features in **higher layers** relate to object-level concepts such as `object categories`. Instead, we focus on **middle-level features** that may constitute object parts shared by `unseen classes`.
- **Dense Comparison**: Here, they use **global average pooling** over the foreground area to `squeeze the feature maps to a feature vector`, global image features turn out to be useful in segmentation tasks. After obtained the global feature vector from the support set, they `concatenate the vector with all spatial locations` in the feature map generated by the query branch.

### Iterative Optimization Module(IOM)
> They propose to incorporate the **predicted masks** in a residual form: $$M_t = x+F(x,y_{t-1})$$  
> They use Atrous Spatial Pyramid Pooling module (**ASPP**) proposed to `capture multi-scale information`.

## Core Conception
![CANet_Attention.png](https://i.loli.net/2020/10/20/qFafGcTpuZsdnPw.png)
![CANet_annotations.png](https://i.loli.net/2020/10/20/IPkyzhgEBZ83VRX.png)

## Experiments
![CANet_results.png](https://i.loli.net/2020/10/20/qOARDmlH65MiVQ7.png)
![CANet_Qualitative.png](https://i.loli.net/2020/10/20/nIA1QBVsiSwrFoU.png)
![CANet_IOMprocess.png](https://i.loli.net/2020/10/20/AD9XSWOMawiqvy4.png)
![CANet_evaluation.png](https://i.loli.net/2020/10/20/JRVxb2HB4QFm1A9.png)
![CANet_Ablation.png](https://i.loli.net/2020/10/20/k2Iy3bQWf7lP6zH.png)
![CANet_5-shot.png](https://i.loli.net/2020/10/20/PBHWo8JjAKTqyhM.png)
![CANet_COCO.png](https://i.loli.net/2020/10/20/8EOoXR2GNrCuKIS.png)

# Code
---
[Updating]

# Note
---
- Well described the latent details in feature map and its process.

# References
---
> [1] Zhang C, Lin G, Liu F, et al. Canet: Class-agnostic segmentation networks with iterative refinement and attentive few-shot learning[C]//Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition. 2019: 5217-5226.  
> [2] CaNet. https://github.com/icoz69/CaNet.
